b722eb3bbcec8fbd754b6a8c40298122
'use strict';

var utils = require("./../utils");

var buildURL = require("../helpers/buildURL");

var InterceptorManager = require("./InterceptorManager");

var dispatchRequest = require("./dispatchRequest");

var mergeConfig = require("./mergeConfig");

var validator = require("../helpers/validator");

var validators = validator.validators;

function Axios(instanceConfig) {
  this.defaults = instanceConfig;
  this.interceptors = {
    request: new InterceptorManager(),
    response: new InterceptorManager()
  };
}

Axios.prototype.request = function request(config) {
  if (typeof config === 'string') {
    config = arguments[1] || {};
    config.url = arguments[0];
  } else {
    config = config || {};
  }

  config = mergeConfig(this.defaults, config);

  if (config.method) {
    config.method = config.method.toLowerCase();
  } else if (this.defaults.method) {
    config.method = this.defaults.method.toLowerCase();
  } else {
    config.method = 'get';
  }

  var transitional = config.transitional;

  if (transitional !== undefined) {
    validator.assertOptions(transitional, {
      silentJSONParsing: validators.transitional(validators.boolean),
      forcedJSONParsing: validators.transitional(validators.boolean),
      clarifyTimeoutError: validators.transitional(validators.boolean)
    }, false);
  }

  var requestInterceptorChain = [];
  var synchronousRequestInterceptors = true;
  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {
    if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {
      return;
    }

    synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;
    requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);
  });
  var responseInterceptorChain = [];
  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {
    responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);
  });
  var promise;

  if (!synchronousRequestInterceptors) {
    var chain = [dispatchRequest, undefined];
    Array.prototype.unshift.apply(chain, requestInterceptorChain);
    chain = chain.concat(responseInterceptorChain);
    promise = Promise.resolve(config);

    while (chain.length) {
      promise = promise.then(chain.shift(), chain.shift());
    }

    return promise;
  }

  var newConfig = config;

  while (requestInterceptorChain.length) {
    var onFulfilled = requestInterceptorChain.shift();
    var onRejected = requestInterceptorChain.shift();

    try {
      newConfig = onFulfilled(newConfig);
    } catch (error) {
      onRejected(error);
      break;
    }
  }

  try {
    promise = dispatchRequest(newConfig);
  } catch (error) {
    return Promise.reject(error);
  }

  while (responseInterceptorChain.length) {
    promise = promise.then(responseInterceptorChain.shift(), responseInterceptorChain.shift());
  }

  return promise;
};

Axios.prototype.getUri = function getUri(config) {
  config = mergeConfig(this.defaults, config);
  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\?/, '');
};

utils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {
  Axios.prototype[method] = function (url, config) {
    return this.request(mergeConfig(config || {}, {
      method: method,
      url: url,
      data: (config || {}).data
    }));
  };
});
utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  Axios.prototype[method] = function (url, data, config) {
    return this.request(mergeConfig(config || {}, {
      method: method,
      url: url,
      data: data
    }));
  };
});
module.exports = Axios;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkF4aW9zLmpzIl0sIm5hbWVzIjpbInV0aWxzIiwicmVxdWlyZSIsImJ1aWxkVVJMIiwiSW50ZXJjZXB0b3JNYW5hZ2VyIiwiZGlzcGF0Y2hSZXF1ZXN0IiwibWVyZ2VDb25maWciLCJ2YWxpZGF0b3IiLCJ2YWxpZGF0b3JzIiwiQXhpb3MiLCJpbnN0YW5jZUNvbmZpZyIsImRlZmF1bHRzIiwiaW50ZXJjZXB0b3JzIiwicmVxdWVzdCIsInJlc3BvbnNlIiwicHJvdG90eXBlIiwiY29uZmlnIiwiYXJndW1lbnRzIiwidXJsIiwibWV0aG9kIiwidG9Mb3dlckNhc2UiLCJ0cmFuc2l0aW9uYWwiLCJ1bmRlZmluZWQiLCJhc3NlcnRPcHRpb25zIiwic2lsZW50SlNPTlBhcnNpbmciLCJib29sZWFuIiwiZm9yY2VkSlNPTlBhcnNpbmciLCJjbGFyaWZ5VGltZW91dEVycm9yIiwicmVxdWVzdEludGVyY2VwdG9yQ2hhaW4iLCJzeW5jaHJvbm91c1JlcXVlc3RJbnRlcmNlcHRvcnMiLCJmb3JFYWNoIiwidW5zaGlmdFJlcXVlc3RJbnRlcmNlcHRvcnMiLCJpbnRlcmNlcHRvciIsInJ1bldoZW4iLCJzeW5jaHJvbm91cyIsInVuc2hpZnQiLCJmdWxmaWxsZWQiLCJyZWplY3RlZCIsInJlc3BvbnNlSW50ZXJjZXB0b3JDaGFpbiIsInB1c2hSZXNwb25zZUludGVyY2VwdG9ycyIsInB1c2giLCJwcm9taXNlIiwiY2hhaW4iLCJBcnJheSIsImFwcGx5IiwiY29uY2F0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJsZW5ndGgiLCJ0aGVuIiwic2hpZnQiLCJuZXdDb25maWciLCJvbkZ1bGZpbGxlZCIsIm9uUmVqZWN0ZWQiLCJlcnJvciIsInJlamVjdCIsImdldFVyaSIsInBhcmFtcyIsInBhcmFtc1NlcmlhbGl6ZXIiLCJyZXBsYWNlIiwiZm9yRWFjaE1ldGhvZE5vRGF0YSIsImRhdGEiLCJmb3JFYWNoTWV0aG9kV2l0aERhdGEiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBp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QU8sS0FBS0gsT0FBTCxDQUFhUCxXQUFXLENBQUNVLE1BQU0sSUFBSSxFQUFYLEVBQWU7QUFDNUNHLE1BQUFBLE1BQU0sRUFBRUEsTUFEb0M7QUFFNUNELE1BQUFBLEdBQUcsRUFBRUEsR0FGdUM7QUFHNUMyQyxNQUFBQSxJQUFJLEVBQUUsQ0FBQzdDLE1BQU0sSUFBSSxFQUFYLEVBQWU2QztBQUh1QixLQUFmLENBQXhCLENBQVA7QUFLRCxHQU5EO0FBT0QsQ0FURDtBQVdBNUQsS0FBSyxDQUFDNkIsT0FBTixDQUFjLENBQUMsTUFBRCxFQUFTLEtBQVQsRUFBZ0IsT0FBaEIsQ0FBZCxFQUF3QyxTQUFTZ0MscUJBQVQsQ0FBK0IzQyxNQUEvQixFQUF1QztBQUU3RVYsRUFBQUEsS0FBSyxDQUFDTSxTQUFOLENBQWdCSSxNQUFoQixJQUEwQixVQUFTRCxHQUFULEVBQWMyQyxJQUFkLEVBQW9CN0MsTUFBcEIsRUFBNEI7QUFDcEQsV0FBTyxLQUFLSCxPQUFMLENBQWFQLFdBQVcsQ0FBQ1UsTUFBTSxJQUFJLEVBQVgsRUFBZTtBQUM1Q0csTUFBQUEsTUFBTSxFQUFFQSxNQURvQztBQUU1Q0QsTUFBQUEsR0FBRyxFQUFFQSxHQUZ1QztBQUc1QzJDLE1BQUFBLElBQUksRUFBRUE7QUFIc0MsS0FBZixDQUF4QixDQUFQO0FBS0QsR0FORDtBQU9ELENBVEQ7QUFXQUUsTUFBTSxDQUFDQyxPQUFQLEdBQWlCdkQsS0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcbnZhciBidWlsZFVSTCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvYnVpbGRVUkwnKTtcbnZhciBJbnRlcmNlcHRvck1hbmFnZXIgPSByZXF1aXJlKCcuL0ludGVyY2VwdG9yTWFuYWdlcicpO1xudmFyIGRpc3BhdGNoUmVxdWVzdCA9IHJlcXVpcmUoJy4vZGlzcGF0Y2hSZXF1ZXN0Jyk7XG52YXIgbWVyZ2VDb25maWcgPSByZXF1aXJlKCcuL21lcmdlQ29uZmlnJyk7XG52YXIgdmFsaWRhdG9yID0gcmVxdWlyZSgnLi4vaGVscGVycy92YWxpZGF0b3InKTtcblxudmFyIHZhbGlkYXRvcnMgPSB2YWxpZGF0b3IudmFsaWRhdG9ycztcbi8qKlxuICogQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEF4aW9zXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGluc3RhbmNlQ29uZmlnIFRoZSBkZWZhdWx0IGNvbmZpZyBmb3IgdGhlIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIEF4aW9zKGluc3RhbmNlQ29uZmlnKSB7XG4gIHRoaXMuZGVmYXVsdHMgPSBpbnN0YW5jZUNvbmZpZztcbiAgdGhpcy5pbnRlcmNlcHRvcnMgPSB7XG4gICAgcmVxdWVzdDogbmV3IEludGVyY2VwdG9yTWFuYWdlcigpLFxuICAgIHJlc3BvbnNlOiBuZXcgSW50ZXJjZXB0b3JNYW5hZ2VyKClcbiAgfTtcbn1cblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcXVlc3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcgc3BlY2lmaWMgZm9yIHRoaXMgcmVxdWVzdCAobWVyZ2VkIHdpdGggdGhpcy5kZWZhdWx0cylcbiAqL1xuQXhpb3MucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbiByZXF1ZXN0KGNvbmZpZykge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgLy8gQWxsb3cgZm9yIGF4aW9zKCdleGFtcGxlL3VybCdbLCBjb25maWddKSBhIGxhIGZldGNoIEFQSVxuICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25maWcgPSBhcmd1bWVudHNbMV0gfHwge307XG4gICAgY29uZmlnLnVybCA9IGFyZ3VtZW50c1swXTtcbiAgfSBlbHNlIHtcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XG4gIH1cblxuICBjb25maWcgPSBtZXJnZUNvbmZpZyh0aGlzLmRlZmF1bHRzLCBjb25maWcpO1xuXG4gIC8vIFNldCBjb25maWcubWV0aG9kXG4gIGlmIChjb25maWcubWV0aG9kKSB7XG4gICAgY29uZmlnLm1ldGhvZCA9IGNvbmZpZy5tZXRob2QudG9Mb3dlckNhc2UoKTtcbiAgfSBlbHNlIGlmICh0aGlzLmRlZmF1bHRzLm1ldGhvZCkge1xuICAgIGNvbmZpZy5tZXRob2QgPSB0aGlzLmRlZmF1bHRzLm1ldGhvZC50b0xvd2VyQ2FzZSgpO1xuICB9IGVsc2Uge1xuICAgIGNvbmZpZy5tZXRob2QgPSAnZ2V0JztcbiAgfVxuXG4gIHZhciB0cmFuc2l0aW9uYWwgPSBjb25maWcudHJhbnNpdGlvbmFsO1xuXG4gIGlmICh0cmFuc2l0aW9uYWwgIT09IHVuZGVmaW5lZCkge1xuICAgIHZhbGlkYXRvci5hc3NlcnRPcHRpb25zKHRyYW5zaXRpb25hbCwge1xuICAgICAgc2lsZW50SlNPTlBhcnNpbmc6IHZhbGlkYXRvcnMudHJhbnNpdGlvbmFsKHZhbGlkYXRvcnMuYm9vbGVhbiksXG4gICAgICBmb3JjZWRKU09OUGFyc2luZzogdmFsaWRhdG9ycy50cmFuc2l0aW9uYWwodmFsaWRhdG9ycy5ib29sZWFuKSxcbiAgICAgIGNsYXJpZnlUaW1lb3V0RXJyb3I6IHZhbGlkYXRvcnMudHJhbnNpdGlvbmFsKHZhbGlkYXRvcnMuYm9vbGVhbilcbiAgICB9LCBmYWxzZSk7XG4gIH1cblxuICAvLyBmaWx0ZXIgb3V0IHNraXBwZWQgaW50ZXJjZXB0b3JzXG4gIHZhciByZXF1ZXN0SW50ZXJjZXB0b3JDaGFpbiA9IFtdO1xuICB2YXIgc3luY2hyb25vdXNSZXF1ZXN0SW50ZXJjZXB0b3JzID0gdHJ1ZTtcbiAgdGhpcy5pbnRlcmNlcHRvcnMucmVxdWVzdC5mb3JFYWNoKGZ1bmN0aW9uIHVuc2hpZnRSZXF1ZXN0SW50ZXJjZXB0b3JzKGludGVyY2VwdG9yKSB7XG4gICAgaWYgKHR5cGVvZiBpbnRlcmNlcHRvci5ydW5XaGVuID09PSAnZnVuY3Rpb24nICYmIGludGVyY2VwdG9yLnJ1bldoZW4oY29uZmlnKSA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzeW5jaHJvbm91c1JlcXVlc3RJbnRlcmNlcHRvcnMgPSBzeW5jaHJvbm91c1JlcXVlc3RJbnRlcmNlcHRvcnMgJiYgaW50ZXJjZXB0b3Iuc3luY2hyb25vdXM7XG5cbiAgICByZXF1ZXN0SW50ZXJjZXB0b3JDaGFpbi51bnNoaWZ0KGludGVyY2VwdG9yLmZ1bGZpbGxlZCwgaW50ZXJjZXB0b3IucmVqZWN0ZWQpO1xuICB9KTtcblxuICB2YXIgcmVzcG9uc2VJbnRlcmNlcHRvckNoYWluID0gW107XG4gIHRoaXMuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLmZvckVhY2goZnVuY3Rpb24gcHVzaFJlc3BvbnNlSW50ZXJjZXB0b3JzKGludGVyY2VwdG9yKSB7XG4gICAgcmVzcG9uc2VJbnRlcmNlcHRvckNoYWluLnB1c2goaW50ZXJjZXB0b3IuZnVsZmlsbGVkLCBpbnRlcmNlcHRvci5yZWplY3RlZCk7XG4gIH0pO1xuXG4gIHZhciBwcm9taXNlO1xuXG4gIGlmICghc3luY2hyb25vdXNSZXF1ZXN0SW50ZXJjZXB0b3JzKSB7XG4gICAgdmFyIGNoYWluID0gW2Rpc3BhdGNoUmVxdWVzdCwgdW5kZWZpbmVkXTtcblxuICAgIEFycmF5LnByb3RvdHlwZS51bnNoaWZ0LmFwcGx5KGNoYWluLCByZXF1ZXN0SW50ZXJjZXB0b3JDaGFpbik7XG4gICAgY2hhaW4gPSBjaGFpbi5jb25jYXQocmVzcG9uc2VJbnRlcmNlcHRvckNoYWluKTtcblxuICAgIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoY29uZmlnKTtcbiAgICB3aGlsZSAoY2hhaW4ubGVuZ3RoKSB7XG4gICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKGNoYWluLnNoaWZ0KCksIGNoYWluLnNoaWZ0KCkpO1xuICAgIH1cblxuICAgIHJldHVybiBwcm9taXNlO1xuICB9XG5cblxuICB2YXIgbmV3Q29uZmlnID0gY29uZmlnO1xuICB3aGlsZSAocmVxdWVzdEludGVyY2VwdG9yQ2hhaW4ubGVuZ3RoKSB7XG4gICAgdmFyIG9uRnVsZmlsbGVkID0gcmVxdWVzdEludGVyY2VwdG9yQ2hhaW4uc2hpZnQoKTtcbiAgICB2YXIgb25SZWplY3RlZCA9IHJlcXVlc3RJbnRlcmNlcHRvckNoYWluLnNoaWZ0KCk7XG4gICAgdHJ5IHtcbiAgICAgIG5ld0NvbmZpZyA9IG9uRnVsZmlsbGVkKG5ld0NvbmZpZyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIG9uUmVqZWN0ZWQoZXJyb3IpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgdHJ5IHtcbiAgICBwcm9taXNlID0gZGlzcGF0Y2hSZXF1ZXN0KG5ld0NvbmZpZyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgfVxuXG4gIHdoaWxlIChyZXNwb25zZUludGVyY2VwdG9yQ2hhaW4ubGVuZ3RoKSB7XG4gICAgcHJvbWlzZSA9IHByb21pc2UudGhlbihyZXNwb25zZUludGVyY2VwdG9yQ2hhaW4uc2hpZnQoKSwgcmVzcG9uc2VJbnRlcmNlcHRvckNoYWluLnNoaWZ0KCkpO1xuICB9XG5cbiAgcmV0dXJuIHByb21pc2U7XG59O1xuXG5BeGlvcy5wcm90b3R5cGUuZ2V0VXJpID0gZnVuY3Rpb24gZ2V0VXJpKGNvbmZpZykge1xuICBjb25maWcgPSBtZXJnZUNvbmZpZyh0aGlzLmRlZmF1bHRzLCBjb25maWcpO1xuICByZXR1cm4gYnVpbGRVUkwoY29uZmlnLnVybCwgY29uZmlnLnBhcmFtcywgY29uZmlnLnBhcmFtc1NlcmlhbGl6ZXIpLnJlcGxhY2UoL15cXD8vLCAnJyk7XG59O1xuXG4vLyBQcm92aWRlIGFsaWFzZXMgZm9yIHN1cHBvcnRlZCByZXF1ZXN0IG1ldGhvZHNcbnV0aWxzLmZvckVhY2goWydkZWxldGUnLCAnZ2V0JywgJ2hlYWQnLCAnb3B0aW9ucyddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kTm9EYXRhKG1ldGhvZCkge1xuICAvKmVzbGludCBmdW5jLW5hbWVzOjAqL1xuICBBeGlvcy5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKHVybCwgY29uZmlnKSB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChtZXJnZUNvbmZpZyhjb25maWcgfHwge30sIHtcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgdXJsOiB1cmwsXG4gICAgICBkYXRhOiAoY29uZmlnIHx8IHt9KS5kYXRhXG4gICAgfSkpO1xuICB9O1xufSk7XG5cbnV0aWxzLmZvckVhY2goWydwb3N0JywgJ3B1dCcsICdwYXRjaCddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kV2l0aERhdGEobWV0aG9kKSB7XG4gIC8qZXNsaW50IGZ1bmMtbmFtZXM6MCovXG4gIEF4aW9zLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24odXJsLCBkYXRhLCBjb25maWcpIHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KG1lcmdlQ29uZmlnKGNvbmZpZyB8fCB7fSwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICB1cmw6IHVybCxcbiAgICAgIGRhdGE6IGRhdGFcbiAgICB9KSk7XG4gIH07XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBeGlvcztcbiJdfQ==